<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HeatPower | ×¡×™××•×œ×˜×•×¨ ×× ×¨×’×™×”</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Assistant', sans-serif; background-color: #010409; color: #e6edf3; }
        .text-primary { color: #f0f6fc; } 
        .text-secondary { color: #8b949e; } 
        .text-accent { color: #58a6ff; }
        .navbar { position: fixed; top: 0; left: 0; width: 100%; background-color: rgba(1, 4, 9, 0.7); backdrop-filter: blur(10px); z-index: 100; border-bottom: 1px solid #30363d; }
        .page-hero { text-align: center; background-image: linear-gradient(rgba(1, 4, 9, 0.7), rgba(1, 4, 9, 0.7)), url('hero-simulation.jpg'); background-size: cover; background-position: center; }
        .table-responsive { overflow-x: auto; }
        input[type="range"]::-webkit-slider-runnable-track { background: #30363d; }
        input[type="range"]::-moz-range-track { background: #30363d; }
        input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; margin-top: -6px; background-color: #58a6ff; height: 24px; width: 24px; border-radius: 50%; cursor: pointer; }
        .info-icon { position: relative; display: inline-flex; align-items: center; justify-content: center; cursor: pointer; margin-right: 8px; color: #8b949e; border: 1px solid #484f58; border-radius: 9999px; width: 20px; height: 20px; font-style: normal; font-weight: bold; background: none; }
        .info-icon .tooltip-text { visibility: hidden; width: 280px; background-color: #161b22; color: #fff; text-align: right; border-radius: 6px; padding: 8px; position: absolute; z-index: 10; bottom: 125%; left: 50%; transform: translateX(-50%); opacity: 0; transition: opacity 0.3s; font-weight: normal; }
        .info-icon:hover .tooltip-text, .info-icon:focus .tooltip-text { visibility: visible; opacity: 1; }
        @media (max-width: 480px) { .info-icon .tooltip-text { width: auto; left: 16px; right: 16px; transform: translateX(0); } }
    </style>
</head>
<body class="bg-slate-900">
   <header class="navbar">
    <nav class="container mx-auto px-4 sm:px-6 py-4 flex justify-between items-center">
        <div class="text-3xl font-bold text-accent tracking-wider">HeatPower</div>
        <ul class="hidden lg:flex items-center text-md font-semibold space-x-6 space-x-reverse">
            <li><a href="index.html" class="text-gray-300 hover:text-accent transition-colors">×“×£ ×”×‘×™×ª</a></li>
            <li><a href="presentation.html" class="text-gray-300 hover:text-accent transition-colors">×”×”×–×“×× ×•×ª</a></li>
            <li><a href="market-analysis.html" class="text-gray-300 hover:text-accent transition-colors">×©×•×§ ×•××ª×—×¨×™×</a></li>
            <li><a href="technology.html" class="text-gray-300 hover:text-accent transition-colors">×”×¤×™×ª×•×— ×”×˜×›× ×•×œ×•×’×™</a></li>
            <li><a href="feasibility.html" class="text-gray-300 hover:text-accent transition-colors">×‘×“×™×§×ª ×”×™×ª×›× ×•×ª</a></li>
            <li><a href="business-plan.html" class="text-gray-300 hover:text-accent transition-colors">×”×ª×•×›× ×™×ª ×”×¢×¡×§×™×ª</a></li>
            <li><a href="investors.html" class="text-gray-300 hover:text-accent transition-colors">× ×™×ª×•×— ××—×™×¨</a></li>
            <li><a href="simulation1.html" class="text-white hover:text-accent transition-colors">×¡×™××•×œ×˜×•×¨ ×× ×¨×’×™×”</a></li>
            <li><a href="simulation2.html" class="text-gray-300 hover:text-accent transition-colors">×¡×™××•×œ×˜×•×¨ ×›×œ×›×œ×™</a></li>
            <li><a href="our-story.html" class="text-gray-300 hover:text-accent transition-colors">×”×¡×™×¤×•×¨ ×©×œ× ×•</a></li>
        </ul>
        <div class="lg:hidden">
            <button id="mobile-menu-button" class="text-white focus:outline-none"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg></button>
        </div>
    </nav>
    <div id="mobile-menu" class="hidden lg:hidden bg-slate-800/95 backdrop-blur-sm">
        <a href="index.html" class="block py-3 px-6 text-gray-300 hover:bg-slate-700">×“×£ ×”×‘×™×ª</a>
        <a href="presentation.html" class="block py-3 px-6 text-gray-300 hover:bg-slate-700">×”×”×–×“×× ×•×ª</a>
        <a href="market-analysis.html" class="block py-3 px-6 text-gray-300 hover:bg-slate-700">×©×•×§ ×•××ª×—×¨×™×</a>
        <a href="technology.html" class="block py-3 px-6 text-gray-300 hover:bg-slate-700">×”×¤×™×ª×•×— ×”×˜×›× ×•×œ×•×’×™</a>
        <a href="feasibility.html" class="block py-3 px-6 text-gray-300 hover:bg-slate-700">×‘×“×™×§×ª ×”×™×ª×›× ×•×ª</a>
        <a href="business-plan.html" class="block py-3 px-6 text-gray-300 hover:bg-slate-700">×”×ª×•×›× ×™×ª ×”×¢×¡×§×™×ª</a>
        <a href="investors.html" class="block py-3 px-6 text-gray-300 hover:bg-slate-700">× ×™×ª×•×— ××—×™×¨</a>
        <a href="simulation1.html" class="block py-3 px-6 text-white bg-slate-700">×¡×™××•×œ×˜×•×¨ ×× ×¨×’×™×”</a>
        <a href="simulation2.html" class="block py-3 px-6 text-gray-300 hover:bg-slate-700">×¡×™××•×œ×˜×•×¨ ×›×œ×›×œ×™</a>
        <a href="our-story.html" class="block py-3 px-6 text-gray-300 hover:bg-slate-700">×”×¡×™×¤×•×¨ ×©×œ× ×•</a>
    </div>
</header>
    <main>
        <section class="page-hero pt-32 pb-16 md:pt-48 md:pb-24">
            <div class="max-w-4xl mx-auto px-4 sm:px-6">
                <h1 class="text-4xl md:text-7xl font-extrabold text-primary leading-tight">×¡×™××•×œ×˜×•×¨ ×××–×Ÿ ×× ×¨×’×™×”</h1>
                <p class="mt-4 text-lg md:text-2xl text-secondary">×¡×™××•×œ×¦×™×” ×”××“×’×™××” ××ª ×××–×Ÿ ×”×× ×¨×’×™×” ×©×œ ×”××¢×¨×›×ª, ×ª×•×š ×”×ª×—×©×‘×•×ª ×‘× ×ª×•× ×™× ×ª×¨××•×“×™× ××™×™× ×•×™×¢×™×œ×•×ª ×¨×›×™×‘×™× ××©×ª× ×”.</p>
            </div>
        </section>
        <div class="container mx-auto px-4 sm:px-6 py-12 md:py-20">
            <div class="flex flex-col lg:flex-row gap-8">
                <aside class="w-full lg:w-1/3 bg-slate-800/50 border border-slate-700 p-6 rounded-lg self-start lg:sticky lg:top-28">
                    <h2 class="text-2xl font-bold mb-6 text-accent">ğŸ”§ ×›×•×•× ×Ÿ ×¤×¨××˜×¨×™×</h2>
                    <div class="space-y-8">
                        <div>
                            <label for="eta_reaction_slider" class="block font-semibold mb-2 flex items-center">×™×¢×™×œ×•×ª ×”×¢×‘×¨×ª ×—×•× <button class="info-icon" aria-label="××™×“×¢ ×¢×œ ×™×¢×™×œ×•×ª ×”×¢×‘×¨×ª ×—×•×">â“˜<span class="tooltip-text">××—×•×– ×”×—×•× ××ª×’×•×‘×ª ×”×“×™×œ×•×œ ×©×× ×•×¦×œ ×‘×¤×•×¢×œ ×œ×ª×”×œ×™×š ×”××™×“×•×™. ×”×©××¨ ××•×‘×“ ×œ×¡×‘×™×‘×”.</span></button></label>
                            <div class="flex flex-col sm:flex-row items-center sm:space-x-4 sm:space-x-reverse">
                                <input type="range" id="eta_reaction_slider" min="50" max="100" value="95" step="1" class="w-full h-2.5 rounded-lg appearance-none cursor-pointer">
                                <span id="eta_reaction_value" class="font-bold text-teal-400 w-24 text-center text-lg mt-2 sm:mt-0">95%</span>
                            </div>
                        </div>
                        <div>
                            <label for="steam_temp_slider" class="block font-semibold mb-2 flex items-center">×˜××¤×¨×˜×•×¨×ª ×§×™×˜×•×¨ <button class="info-icon" aria-label="××™×“×¢ ×¢×œ ×˜××¤×¨×˜×•×¨×ª ×§×™×˜×•×¨">â“˜<span class="tooltip-text">×˜××¤×¨×˜×•×¨×” ×’×‘×•×”×” ×™×•×ª×¨ ××¢×œ×” ××ª ×œ×—×¥ ×”×§×™×˜×•×¨ ×•××ª ×™×¢×™×œ×•×ª ×”×˜×•×¨×‘×™× ×”, ×•××©×¤×™×¢×” ×¢×œ ×¨×•×•×— ×”×× ×¨×’×™×” ×”× ×§×™.</span></button></label>
                            <div class="flex flex-col sm:flex-row items-center sm:space-x-4 sm:space-x-reverse">
                                <input type="range" id="steam_temp_slider" min="100" max="250" value="180" step="1" class="w-full h-2.5 rounded-lg appearance-none cursor-pointer">
                                <span id="steam_temp_value" class="font-bold text-orange-400 w-24 text-center text-lg mt-2 sm:mt-0">180Â°C</span>
                            </div>
                        </div>
                        <div>
                            <label for="ambient_temp_slider" class="block font-semibold mb-2 flex items-center">×˜××¤×¨×˜×•×¨×ª ×¡×‘×™×‘×” <button class="info-icon" aria-label="××™×“×¢ ×¢×œ ×˜××¤×¨×˜×•×¨×ª ×¡×‘×™×‘×”">â“˜<span class="tooltip-text">×˜××¤×¨×˜×•×¨×ª ×”××§×•×¨ ×”×§×¨. ×™×¢×™×œ×•×ª ××©××‘×ª ×”×—×•× (COP) ×¢×•×œ×” ×›×›×œ ×©×”×¡×‘×™×‘×” ×—××” ×™×•×ª×¨.</span></button></label>
                            <div class="flex flex-col sm:flex-row items-center sm:space-x-4 sm:space-x-reverse">
                                <input type="range" id="ambient_temp_slider" min="-10" max="60" value="25" step="1" class="w-full h-2.5 rounded-lg appearance-none cursor-pointer">
                                <span id="ambient_temp_value" class="font-bold text-orange-400 w-24 text-center text-lg mt-2 sm:mt-0">25Â°C</span>
                            </div>
                        </div>
                    </div>
                    <div class="mt-8 border-t border-slate-700 pt-6">
                         <p class="text-sm text-secondary mb-4">×¨×•×¦×” ×œ×”×‘×™×Ÿ ×œ×¢×•××§ ××ª ×”××ª×’×¨×™× ×•×”× ×™×¡×•×™×™× ×©× ×•×¢×“×• ×œ×××ª ××ª ×”× ×ª×•× ×™× ×”××œ×”? ×ª×•×›× ×™×ª ×”××—×§×¨ ×”××œ××” × ××¦××ª ×›××Ÿ.</p>
                         <a href="feasibility.html" class="block text-center bg-transparent border-2 border-accent text-accent font-bold py-2 px-4 rounded-full text-md transition-colors hover:bg-accent hover:text-white w-full">×¦×¤×” ×‘×ª×•×›× ×™×ª ×”××™××•×ª ×”××—×§×¨×™×ª</a>
                    </div>
                </aside>
                <div class="w-full lg:w-2/3 space-y-8">
                    <div class="bg-slate-800/50 border border-slate-700 p-6 rounded-lg">
                        <h3 class="text-2xl font-bold mb-4 text-primary">ğŸ“Š ×¡×™×›×•× ×‘×™×¦×•×¢×™×</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
                            <div><p class="text-secondary flex items-center">×¨×•×•×— ×× ×¨×’×™×” × ×§×™<button class="info-icon" aria-label="××™×“×¢ ×¢×œ ×¨×•×•×— ×× ×¨×’×™×”">â“˜<span class="tooltip-text">×”×”×¤×¨×© ×‘×™×Ÿ ×”×—×©××œ ×”××™×•×¦×¨ ×‘×˜×•×¨×‘×™× ×” ×œ×—×©××œ ×”× ×¦×¨×š ×¢"×™ ××©××‘×ª ×”×—×•×. ×¢×¨×š ×—×™×•×‘×™ = ×¢×•×“×£ ×× ×¨×’×™×”.</span></button></p><span id="net_energy_value" class="text-3xl font-bold text-green-400"></span></div>
                            <div><p class="text-secondary flex items-center">×™×¢×™×œ×•×ª ×›×•×œ×œ×ª<button class="info-icon" aria-label="××™×“×¢ ×¢×œ ×™×¢×™×œ×•×ª ×›×•×œ×œ×ª">â“˜<span class="tooltip-text">×”×™×—×¡ (×‘××—×•×–×™×) ×‘×™×Ÿ ×¨×•×•×— ×”×× ×¨×’×™×” ×”× ×§×™ ×œ×× ×¨×’×™×” ×”×›×™××™×ª ×©×”×•×©×§×¢×” (70 kJ).</span></button></p><span id="system_efficiency_value" class="text-3xl font-bold text-blue-400"></span></div>
                            <div><p class="text-secondary flex items-center">××§×“× ×‘×™×¦×•×¢×™× (COP)<button class="info-icon" aria-label="××™×“×¢ ×¢×œ ××§×“× ×‘×™×¦×•×¢×™×">â“˜<span class="tooltip-text">×™×¢×™×œ×•×ª ××©××‘×ª ×”×—×•× (QH/Win). ×ª×œ×•×™ ×‘×”×¤×¨×© ×”×˜××¤×¨×˜×•×¨×•×ª ×‘×™×Ÿ ×”×¡×‘×™×‘×” ×œ×××“×”.</span></button></p><span id="calculated_cop_value" class="text-3xl font-bold text-teal-400"></span></div>
                            <div><p class="text-secondary flex items-center">×™×¢×™×œ×•×ª ×˜×•×¨×‘×™× ×”<button class="info-icon" aria-label="××™×“×¢ ×¢×œ ×™×¢×™×œ×•×ª ×˜×•×¨×‘×™× ×”">â“˜<span class="tooltip-text">××—×•×– ×”×× ×¨×’×™×” ×‘×§×™×˜×•×¨ ×©×”×•×¤×š ×œ×¢×‘×•×“×” ×—×©××œ×™×ª. ×¢×•×œ×” ×¢× ×˜××¤×¨×˜×•×¨×ª ×”×§×™×˜×•×¨.</span></button></p><span id="turbine_efficiency_value" class="text-3xl font-bold text-purple-400"></span></div>
                            <div><p class="text-secondary flex items-center">×× ×¨×’×™×” ×¡×‘×™×‘×ª×™×ª (QC)<button class="info-icon" aria-label="××™×“×¢ ×¢×œ ×× ×¨×’×™×” ×¡×‘×™×‘×ª×™×ª">â“˜<span class="tooltip-text">×›××•×ª ×”×—×•× ×©××©××‘×ª ×”×—×•× "×©×•××‘×ª" ××”×¡×‘×™×‘×” ×›×“×™ ×œ×¡×™×™×¢ ×‘××™×“×•×™.</span></button></p><span id="cooling_power_value" class="text-3xl font-bold text-cyan-400"></span></div>
                            <div><p class="text-secondary flex items-center">×œ×—×¥ ×§×™×˜×•×¨ (××©×•×¢×¨)<button class="info-icon" aria-label="××™×“×¢ ×¢×œ ×œ×—×¥ ×§×™×˜×•×¨">â“˜<span class="tooltip-text">×”×œ×—×¥ ×‘×›× ×™×¡×” ×œ×˜×•×¨×‘×™× ×”. × ×§×‘×¢ ×¢×œ ×¤×™ ×˜××¤×¨×˜×•×¨×ª ×”×§×™×˜×•×¨ ×©× ×‘×—×¨×”.</span></button></p><span id="steam_pressure_value" class="text-3xl font-bold text-orange-400"></span></div>
                        </div>
                    </div>
                    <div class="bg-slate-800/50 border border-slate-700 p-6 rounded-lg">
                        <h3 class="text-2xl font-bold mb-4 text-primary">ğŸ”¢ ×¤×™×¨×•×˜ ×××–×Ÿ ×”×× ×¨×’×™×”</h3>
                        <div class="table-responsive"><table class="w-full text-right min-w-[340px]"><thead><tr class="border-b-2 border-slate-700 text-secondary"><th class="py-2 font-semibold">×©×œ×‘</th><th class="py-2 font-semibold">×¢×¨×š (kJ)</th><th class="py-2 font-semibold">% ××”×§×œ×˜ ×”×›×™××™</th></tr></thead><tbody id="balance_table_body"></tbody></table></div>
                    </div>
                     <div class="bg-slate-800/50 border border-slate-700 p-6 rounded-lg">
                        <h3 class="text-2xl font-bold mb-4 text-primary">×™×¢×™×œ×•×ª ×”××¢×¨×›×ª ×›×ª×œ×•×ª ×‘×˜××¤×¨×˜×•×¨×ª ×”×¡×‘×™×‘×”</h3>
                        <div class="relative h-96"><canvas id="efficiencyChart"></canvas></div>
                    </div>
                    <div id="scientific-appendix" class="bg-slate-800/50 border border-slate-700 p-6 rounded-lg space-y-8">
                        </div>
                </div>
            </div>
        </div>
    </main>
    <footer class="bg-gray-900 text-gray-500 text-center py-6 border-t border-gray-700"><p>&copy; 2025 HeatPower. ×›×œ ×”×–×›×•×™×•×ª ×©××•×¨×•×ª.</p></footer>
    <script>
        const sliders = { eta_reaction: document.getElementById('eta_reaction_slider'), steam_temp: document.getElementById('steam_temp_slider'), ambient_temp: document.getElementById('ambient_temp_slider') };
        const values = { eta_reaction: document.getElementById('eta_reaction_value'), steam_temp: document.getElementById('steam_temp_value'), ambient_temp: document.getElementById('ambient_temp_value') };
        const outputs = { net_energy_value: document.getElementById('net_energy_value'), system_efficiency_value: document.getElementById('system_efficiency_value'), steam_pressure_value: document.getElementById('steam_pressure_value'), turbine_efficiency_value: document.getElementById('turbine_efficiency_value'), calculated_cop_value: document.getElementById('calculated_cop_value'), cooling_power_value: document.getElementById('cooling_power_value'), balance_table_body: document.getElementById('balance_table_body'), appendix_container: document.getElementById('scientific-appendix') };
        
        const thermoData = [ { temp: 100, pressure: 1.013, hf: 419.06, hg: 2676.0, eta_turbine: 0.20 }, { temp: 120, pressure: 1.985, hf: 503.71, hg: 2706.3, eta_turbine: 0.22 }, { temp: 150, pressure: 4.76, hf: 632.18, hg: 2746.5, eta_turbine: 0.26 }, { temp: 180, pressure: 10.03, hf: 762.64, hg: 2778.1, eta_turbine: 0.30 }, { temp: 200, pressure: 15.54, hf: 852.26, hg: 2792.8, eta_turbine: 0.33 }, { temp: 250, pressure: 39.73, hf: 1085.6, hg: 2801.4, eta_turbine: 0.38 } ];
        const CONSTANTS = { Q_DILUTION_MOLAR: 70000, MOLAR_RATIO_H2O: 7, H2O_MOLAR_MASS_KG: 0.018015, T_EVAPORATION_K: 373.15, CARNOT_EFFICIENCY_FACTOR: 0.804, COP_MAX: 8.0, };
        let efficiencyChartInstance;

        function interpolate(x, x0, y0, x1, y1) { if (x === x0) return y0; if (x === x1) return y1; return y0 + (x - x0) * (y1 - y0) / (x1 - x0); }
        function getThermoData(temp) { if (temp <= thermoData[0].temp) return thermoData[0]; if (temp >= thermoData[thermoData.length - 1].temp) return thermoData[thermoData.length - 1]; for (let i = 0; i < thermoData.length - 1; i++) { const p0 = thermoData[i]; const p1 = thermoData[i + 1]; if (temp >= p0.temp && temp <= p1.temp) { return { temp: temp, pressure: interpolate(temp, p0.temp, p0.pressure, p1.temp, p1.pressure), hf: interpolate(temp, p0.temp, p0.hf, p1.temp, p1.hf), hg: interpolate(temp, p0.temp, p0.hg, p1.temp, p1.hg), eta_turbine: interpolate(temp, p0.temp, p0.eta_turbine, p1.temp, p1.eta_turbine) }; } } }

        function calculateAndDisplay() {
            const eta_reaction = parseFloat(sliders.eta_reaction.value) / 100; const steam_temp_c = parseFloat(sliders.steam_temp.value); const ambient_temp_c = parseFloat(sliders.ambient_temp.value);
            values.eta_reaction.textContent = `${sliders.eta_reaction.value}%`; values.steam_temp.textContent = `${steam_temp_c.toFixed(0)}Â°C`; values.ambient_temp.textContent = `${ambient_temp_c.toFixed(0)}Â°C`;
            const currentThermo = getThermoData(steam_temp_c);
            const ambient_temp_k = ambient_temp_c + 273.15; const delta_t_k = CONSTANTS.T_EVAPORATION_K - ambient_temp_k;
            let cop_hp = 0; if (delta_t_k > 0) { const carnot_cop = CONSTANTS.T_EVAPORATION_K / delta_t_k; cop_hp = Math.min(carnot_cop * CONSTANTS.CARNOT_EFFICIENCY_FACTOR, CONSTANTS.COP_MAX); }
            
            const Q_dilution_usable = CONSTANTS.Q_DILUTION_MOLAR * eta_reaction;
            const Qvap_total = CONSTANTS.MOLAR_RATIO_H2O * (currentThermo.hg - currentThermo.hf) * 1000 * CONSTANTS.H2O_MOLAR_MASS_KG;
            const QH = Qvap_total - Q_dilution_usable;
            const E_hp_cost = (QH > 0 && cop_hp > 0) ? QH / cop_hp : 0;
            const E_electric_gross = Qvap_total * currentThermo.eta_turbine;
            const E_net = E_electric_gross - E_hp_cost;
            const eta_system = (E_net / CONSTANTS.Q_DILUTION_MOLAR) * 100;
            const Q_cooling = (QH > 0 && E_hp_cost > 0) ? QH - E_hp_cost : 0;

            outputs.net_energy_value.textContent = `${(E_net / 1000).toFixed(2)} kJ`;
            outputs.system_efficiency_value.textContent = `${eta_system.toFixed(2)}%`;
            outputs.steam_pressure_value.textContent = `${currentThermo.pressure.toFixed(2)} bar`;
            outputs.turbine_efficiency_value.textContent = `${(currentThermo.eta_turbine * 100).toFixed(1)}%`;
            outputs.calculated_cop_value.textContent = cop_hp.toFixed(2);
            outputs.cooling_power_value.textContent = `${(Q_cooling / 1000).toFixed(2)} kJ`;
            outputs.net_energy_value.classList.toggle('text-red-400', E_net <= 0); outputs.net_energy_value.classList.toggle('text-green-400', E_net > 0);

            const tableData = [ { label: "1. ×× ×¨×’×™×” ×›×™××™×ª (Î”Hdil)", value: CONSTANTS.Q_DILUTION_MOLAR, percent: 100 }, { label: "2. ×× ×¨×’×™×” ×©××™×©×” (×“×™×œ×•×œ)", value: Q_dilution_usable, percent: (Q_dilution_usable / CONSTANTS.Q_DILUTION_MOLAR) * 100 }, { label: "3. ×¡×š ×× ×¨×’×™×™×ª ××™×“×•×™ (Qvap)", value: Qvap_total, percent: (Qvap_total / CONSTANTS.Q_DILUTION_MOLAR) * 100 }, { label: "4. ×—×•× × ×“×¨×© ×-HP (QH)", value: QH, percent: (QH / CONSTANTS.Q_DILUTION_MOLAR) * 100 }, { label: "5. ×—×©××œ ××•×¤×§ (Wout)", value: E_electric_gross, percent: (E_electric_gross / CONSTANTS.Q_DILUTION_MOLAR) * 100 }, { label: "6. ×—×©××œ × ×¦×¨×š (Win)", value: -E_hp_cost, percent: (E_hp_cost / CONSTANTS.Q_DILUTION_MOLAR) * 100 }, { label: `<strong class="text-primary">7. ×¨×•×•×— ×—×©××œ × ×§×™</strong>`, value: E_net, percent: eta_system } ];
            outputs.balance_table_body.innerHTML = tableData.map(row => `<tr class="border-b border-slate-700 text-secondary"><td class="py-3 pr-2">${row.label}</td><td class="py-3 font-mono text-primary">${(row.value / 1000).toFixed(2)}</td><td class="py-3 font-mono text-primary">${row.percent.toFixed(1)}%</td></tr>`).join('');
        }
        
        function injectAppendix() {
            const proofHTML = `
                <h3 class="text-2xl font-bold mb-4 text-primary">× ×¡×¤×— ××“×¢×™: ×”×‘×¡×™×¡ ×”×—×™×©×•×‘×™ ×©×œ ×”××•×“×œ</h3>
                <div class="space-y-6 text-secondary leading-relaxed"><div><h4 class="text-lg font-semibold text-primary">× ×ª×•× ×™× ×•×”× ×—×•×ª ×™×¡×•×“:</h4><ul class="list-disc list-inside mt-2 space-y-1"><li><strong>×™×—×¡ ××—×–×•×¨:</strong> 1 ××•×œ Hâ‚‚SOâ‚„ ×œ-7 ××•×œ Hâ‚‚O</li><li><strong>×× ×¨×’×™×™×ª ×“×™×œ×•×œ (Î”H<sub>dil</sub>):</strong> 70 kJ</li><li><strong>×™×¢×™×œ×•×ª ×˜×•×¨×‘×™× ×” (Î·<sub>turb</sub>):</strong> ××—×•×©×‘ ×“×™× ××™×ª (××§×¨×” ×‘×•×—×Ÿ ×–×” ×× ×™×— 30%)</li><li><strong>××§×“× ×‘×™×¦×•×¢×™× (COP):</strong> ××—×•×©×‘ ×“×™× ××™×ª (××§×¨×” ×‘×•×—×Ÿ ×–×” ×× ×™×— 4)</li></ul></div><div><h4 class="text-lg font-semibold text-primary">×©×œ×‘ 1: ×§×‘×™×¢×ª ×¡×š ×”×× ×¨×’×™×” ×”×“×¨×•×©×” ×œ××™×“×•×™ (Q<sub>vap, total</sub>)</h4><p>×‘×›×œ ××—×–×•×¨, ×™×© ×œ××“×•×ª 7 ××•×œ ××™×. ×× ×ª×œ×¤×™×™×ª ×”××™×“×•×™ ×œ××™× ×”×™× ×›-40.65 kJ/mol.</p><div class="mt-2 p-3 bg-slate-900/50 rounded-md font-mono text-sm text-cyan-300">7 mol Ã— 40.65 kJ/mol = 284.55 kJ</div></div><div><h4 class="text-lg font-semibold text-primary">×©×œ×‘ 2: ×× ×¨×’×™×” × ×“×¨×©×ª ×××©××‘×ª ×—×•× (Q<sub>H</sub>)</h4><p>×–×”×• ×”×”×¤×¨×© ×‘×™×Ÿ ×”×× ×¨×’×™×” ×”×›×•×œ×œ×ª ×œ××™×“×•×™ ×œ×× ×¨×’×™×” ×”××ª×§×‘×œ×ª ××”×“×™×œ×•×œ ×”×›×™××™.</p><div class="mt-2 p-3 bg-slate-900/50 rounded-md font-mono text-sm text-cyan-300">Q<sub>H</sub> = Q<sub>vap, total</sub> - Î”H<sub>dil</sub> = 284.55 kJ - 70 kJ = 214.55 kJ</div></div><div><h4 class="text-lg font-semibold text-primary">×©×œ×‘ 3: ×¢×‘×•×“×” × ×“×¨×©×ª ×œ×”×¤×¢×œ×ª ××©××‘×ª ×”×—×•× (W<sub>in</sub>)</h4><p>×”×¢×‘×•×“×” ×”×—×©××œ×™×ª ×©××©××‘×ª ×”×—×•× ×¦×•×¨×›×ª ×›×“×™ ×œ×¡×¤×§ ××ª ×”×—×•× ×”× ×“×¨×©.</p><div class="mt-2 p-3 bg-slate-900/50 rounded-md font-mono text-sm text-cyan-300">W<sub>in</sub> = Q<sub>H</sub> / COP = 214.55 kJ / 4 = 53.64 kJ</div></div><div><h4 class="text-lg font-semibold text-primary">×©×œ×‘ 4: ×¢×‘×•×“×” ××™×•×¦×¨×ª ××”×˜×•×¨×‘×™× ×” (W<sub>out</sub>)</h4><p>×”×˜×•×¨×‘×™× ×” ×× ×¦×œ×ª ××ª ×›×œ×œ ×× ×¨×’×™×™×ª ×”××™×“×•×™ (Q<sub>vap, total</sub>) ×œ×”×¤×§×ª ×—×©××œ.</p><div class="mt-2 p-3 bg-slate-900/50 rounded-md font-mono text-sm text-cyan-300">W<sub>out</sub> = Q<sub>vap, total</sub> Ã— Î·<sub>turb</sub> = 284.55 kJ Ã— 0.30 = 85.37 kJ</div></div><div><h4 class="text-lg font-bold text-primary">×©×œ×‘ 5: ×××–×Ÿ ×× ×¨×’×™×” × ×˜×•</h4><p>×”×”×¤×¨×© ×‘×™×Ÿ ×”×¢×‘×•×“×” ×”××™×•×¦×¨×ª ×œ×¢×‘×•×“×” ×”× ×¦×¨×›×ª.</p><div class="mt-2 p-4 bg-slate-900/50 rounded-md font-mono text-lg text-green-400"><strong>W<sub>net</sub> = W<sub>out</sub> - W<sub>in</sub> = 85.37 kJ - 53.64 kJ = 31.73 kJ</strong></div></div></div>`;
            const summaryHTML = `<div class="mt-8 border-t border-slate-700 pt-6"><h3 class="text-2xl font-bold mb-4 text-primary">×”×§×©×¨ ×‘×™×Ÿ ×˜××¤×¨×˜×•×¨×ª ×”×§×™×˜×•×¨ ×œ×™×¢×™×œ×•×ª</h3><p class="text-secondary leading-relaxed">×”×¡×™××•×œ×˜×•×¨ ×××“×œ ×¢×™×§×¨×•×Ÿ ××¨×›×–×™ ×‘××¢×¨×›×•×ª ×§×™×˜×•×¨: ×›×›×œ ×©×˜××¤×¨×˜×•×¨×ª ×”×§×™×˜×•×¨ (×•×œ×—×¦×•) ×¢×•×œ×”, ×™×¢×™×œ×•×ª ×”×˜×•×¨×‘×™× ×” (Î·<sub>turb</sub>) ××©×ª×¤×¨×ª ×‘××•×¤×Ÿ ××©××¢×•×ª×™. ×©×™×¤×•×¨ ×–×” ×‘×™×¢×™×œ×•×ª ×œ×¨×•×‘ ××¤×¦×” ×¢×œ ×©×™× ×•×™×™× ×‘×“×¨×™×©×•×ª ×”×× ×¨×’×™×” ×œ××™×“×•×™, ×•×‘×¡×š ×”×›×œ ××•×‘×™×œ ×œ×¨×•×•×— ×× ×¨×’×™×” × ×§×™ ×’×‘×•×” ×™×•×ª×¨. ×”×˜×‘×œ×” ×”×ª×¨××•×“×™× ××™×ª ×”××•×‘× ×™×ª ×‘××•×“×œ ××“×’×™××” ×›×™×¦×“ ×™×¢×™×œ×•×ª ×”×˜×•×¨×‘×™× ×” ×”××©×•×¢×¨×ª ×¢×•×œ×” ×-20% ×‘-100Â°C ×œ-38% ×‘-250Â°C.</p></div>`;
            if (outputs.appendix_container) { outputs.appendix_container.innerHTML = proofHTML + summaryHTML; }
        }

        function renderEfficiencyVsAmbientChart() {
            const ctx = document.getElementById('efficiencyChart');
            if (!ctx) return;
            const context = ctx.getContext('2d');
            const defaultParams = { T_steam: 180, eta_reaction: 0.95, eta_thermal: 0.95, eta_turbine: 0.30 }; // eta_turbine is dynamic
            const ambientTemps = Array.from({length: (60 - (-10)) / 5 + 1}, (_, i) => -10 + i * 5);
            const efficiencies = ambientTemps.map(T_ambient => {
                const cop_hp = Math.max(2.0, (1/15) * T_ambient + (7/3));
                const currentThermo = getThermoData(defaultParams.T_steam);
                const Q_dilution_usable = CONSTANTS.Q_DILUTION_MOLAR * defaultParams.eta_reaction;
                const Qvap_total = CONSTANTS.MOLAR_RATIO_H2O * (currentThermo.hg - currentThermo.hf) * 1000 * CONSTANTS.H2O_MOLAR_MASS_KG;
                const QH = Qvap_total - Q_dilution_usable;
                const E_hp_cost = (QH > 0 && cop_hp > 0) ? QH / cop_hp : 0;
                const E_electric_gross = Qvap_total * currentThermo.eta_turbine;
                const E_net = E_electric_gross - E_hp_cost;
                return (E_net / CONSTANTS.Q_DILUTION_MOLAR) * 100;
            });

            if (efficiencyChartInstance) { efficiencyChartInstance.destroy(); }
            efficiencyChartInstance = new Chart(context, {
                type: 'line',
                data: { labels: ambientTemps.map(t => `${t}Â°C`), datasets: [{ label: '×™×¢×™×œ×•×ª ×”××¢×¨×›×ª (%)', data: efficiencies, borderColor: '#22c55e', backgroundColor: 'rgba(34, 197, 94, 0.1)', tension: 0.3, fill: true, borderWidth: 3, pointBackgroundColor: '#f0f6fc', pointBorderColor: '#22c55e', pointHoverRadius: 7, pointRadius: 5 }] },
                options: { responsive: true, maintainAspectRatio: false, scales: { y: { title: { display: true, text: '×™×¢×™×œ×•×ª ×”××¢×¨×›×ª (%)', color: '#8b949e' }, ticks: { color: '#8b949e', callback: (value) => value.toFixed(1) + '%' }, grid: { color: 'rgba(139, 148, 158, 0.2)' } }, x: { title: { display: true, text: '×˜××¤×¨×˜×•×¨×ª ×¡×‘×™×‘×” (Â°C)', color: '#8b949e' }, ticks: { color: '#8b949e' }, grid: { color: 'rgba(139, 148, 158, 0.2)' } } }, plugins: { legend: { display: false }, tooltip: { enabled: true, backgroundColor: '#161b22', titleFont: { weight: 'bold' }, bodyFont: { size: 14 }, callbacks: { label: function(context) { return `×™×¢×™×œ×•×ª: ${context.parsed.y.toFixed(2)}%`; } } } } }
            });
        }
        
        Object.values(sliders).forEach(slider => slider.addEventListener('input', calculateAndDisplay));
        document.addEventListener('DOMContentLoaded', () => {
            calculateAndDisplay();
            injectAppendix();
            renderEfficiencyVsAmbientChart();
        });

        document.getElementById('mobile-menu-button').addEventListener('click', function() {
            var menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        });
    </script>
</body>
</html>